# =============================================================================
# 기숙사 관리 시스템 설정 파일 - 로컬 개발용 (MySQL)
# =============================================================================

# =============================================================================
# 서버 설정
# =============================================================================
server.port=8080
server.address=0.0.0.0
server.servlet.context-path=/
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

# 서버 성능 설정
server.tomcat.max-threads=200
server.tomcat.min-spare-threads=10
server.tomcat.connection-timeout=20000
server.tomcat.max-connections=8192

# =============================================================================
# Spring 설정
# =============================================================================
# 빈 정의 오버라이드 허용 (JPA Auditing 중복 문제 해결)
spring.main.allow-bean-definition-overriding=true

# 애플리케이션 이름
spring.application.name=dormitory-management-system

# =============================================================================
# 데이터베이스 설정 - 로컬 MySQL
# =============================================================================
spring.datasource.url=jdbc:mysql://localhost:3306/Dormitory_Management?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8
spring.datasource.username=root
spring.datasource.password=1234
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# 연결 풀 설정 (HikariCP)
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# 연결 테스트 설정
spring.datasource.test-while-idle=true
spring.datasource.validation-query=SELECT 1

# =============================================================================
# JPA/Hibernate 설정
# =============================================================================
# 개발환경에서는 update 사용
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
spring.jpa.properties.hibernate.jdbc.time_zone=Asia/Seoul
spring.jpa.open-in-view=false

# 트랜잭션 설정
spring.jpa.properties.hibernate.connection.autocommit=false
spring.jpa.properties.hibernate.current_session_context_class=thread

# =============================================================================
# JPA 설정 강화
# =============================================================================
spring.jpa.hibernate.use-new-id-generator-mappings=true
spring.jpa.database-platform=org.hibernate.dialect.MySQL8Dialect
spring.jpa.properties.hibernate.connection.characterEncoding=utf-8
spring.jpa.properties.hibernate.connection.useUnicode=true
spring.jpa.generate-ddl=true
spring.jpa.properties.hibernate.packagesToScan=com.dormitory.SpringBoot.domain

# 배치 처리 최적화
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# =============================================================================
# 파일 업로드 설정
# =============================================================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.location=${java.io.tmpdir}

# 커스텀 파일 업로드 설정
file.upload.base-path=uploads
file.upload.max-size=5MB
file.upload.allowed-types=jpg,jpeg,png,gif,webp

# =============================================================================
# 보안 설정
# =============================================================================
# JWT 설정
app.jwt.secret=ThisIsAFakeSecretKeyForDevelopmentOnlyChangeInProduction
app.jwt.expiration=86400000

# 암호화 설정
app.encryption.secret-key=ThisIsAFakeEncryptionKey32Chars

# 보안 관련 설정
app.security.max-login-attempts=5
app.security.lockout-duration-minutes=30
app.security.password-expiry-days=90
app.security.session-timeout-minutes=30
app.security.password-min-length=8
app.security.password-require-special-chars=true

# =============================================================================
# 외부 API 설정
# =============================================================================
# Gemini API 설정
gemini.api.key=AIzaSyC0vCsrRvZ9pjy3VfC5kR6bvC4pF6uGWkE
gemini.api.url=https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent
gemini.api.timeout=45000
gemini.api.max-retries=2
gemini.api.max-tokens=2048

# Gemini 응답 처리 설정
gemini.fallback.enabled=true
gemini.fallback.default-score=7
gemini.max-tokens.retry-enabled=true

# =============================================================================
# 애플리케이션 비즈니스 로직 설정
# =============================================================================
# 점호 관련 설정
inspection.pass.score=6
inspection.fail.score=5
inspection.image.max-size=5MB
inspection.auto-cleanup.enabled=true
inspection.auto-cleanup.days=30

# 민원 관련 설정
complaint.auto-assign.enabled=true
complaint.response-time.warning-hours=24
complaint.response-time.critical-hours=72

# =============================================================================
# 로깅 설정
# =============================================================================
# 기본 로그 레벨
logging.level.root=INFO
logging.level.com.dormitory.SpringBoot=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# 로그 파일 설정
logging.file.name=logs/dormitory-management.log
logging.file.max-size=10MB
logging.file.max-history=10

# =============================================================================
# 개발 도구 설정
# =============================================================================
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true

# =============================================================================
# API 문서화 설정 (Swagger)
# =============================================================================
springdoc.api-docs.enabled=true
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.path=/swagger-ui.html

# =============================================================================
# Actuator 설정
# =============================================================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always